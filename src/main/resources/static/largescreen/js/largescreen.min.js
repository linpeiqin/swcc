var myChart1=echarts.init(document.getElementById("echarts1"));var myChart2=echarts.init(document.getElementById("echarts2"));var myChart3=echarts.init(document.getElementById("echarts3"));var myChart4=echarts.init(document.getElementById("echarts4"));var myChart6=echarts.init(document.getElementById("echarts6"));var myChart7=echarts.init(document.getElementById("echarts7"));$(window).load(function(){setInterval(function(){fnDate()},1000)});$(function(){$("html").css({fontSize:$(window).width()/20});myChart1.resize();myChart2.resize();myChart3.resize();myChart4.resize();myChart7.resize();myChart6.resize();initBaiduMap()});function initBaiduMap(){createMap();setMapEvent();addMarker()}function createMap(){var b=new BMap.Map("wcPBaiduMap");var a=new BMap.Point(112.992107,28.194273);b.centerAndZoom(a,18);window.map=b}function setMapEvent(){map.enableDragging();map.enableScrollWheelZoom();map.enableDoubleClickZoom();map.enableKeyboard();map.setMapStyleV2({styleId:"9260a25a95016dc8c9e64c5d62af26c7"})}function addMapControl(){var b=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});map.addControl(b);var a=new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:1});map.addControl(a);var c=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});map.addControl(c)}var markerArr=[{title:"泽福科技",content:"电话：0731-82685268\n手机：18802058397",point:"112.992107|28.194273",isOpen:1,icon:{w:23,h:25,l:46,t:21,x:9,lb:12}}];function addMarker(){for(var f=0;f<markerArr.length;f++){var e=markerArr[f];var h=e.point.split("|")[0];var g=e.point.split("|")[1];var a=new BMap.Point(h,g);var b=new BMap.Marker(a);var c=createInfoWindow(f);var d=new BMap.Label(e.title,{offset:new BMap.Size(e.icon.lb-e.icon.x+10,-20)});b.setLabel(d);map.addOverlay(b);d.setStyle({borderColor:"#808080",color:"#333",cursor:"pointer"});(function(){var i=f;var k=createInfoWindow(f);var j=b;j.addEventListener("click",function(){this.openInfoWindow(k)});k.addEventListener("open",function(){j.getLabel().hide()});k.addEventListener("close",function(){j.getLabel().show()});d.addEventListener("click",function(){j.openInfoWindow(k)});if(!!e.isOpen){d.hide();j.openInfoWindow(k)}})()}}function createInfoWindow(c){var b=markerArr[c];var a=new BMap.InfoWindow("<b class='iw_poi_title' title='"+b.title+"'>"+b.title+"</b><div class='iw_poi_content'>"+b.content+"</div>");return a}function initPage(b){if(b.data){let largeScreen=JSON.parse(b.data);if(largeScreen.isSensorDataUpdate){if(largeScreen.sensorDataVos!=null){sensorDataUlInit(largeScreen.sensorDataVos)}UsagePieInit(largeScreen.waterUsageV,largeScreen.energyUsageV)}if(largeScreen.isSetDataUpdate){for(var a in largeScreen){if(a=="dayGrowth"){$("#"+a).text(largeScreen[a].toFixed(2))}else{$("#"+a).text(largeScreen[a])}}myChartPieInit(largeScreen.avgTime,largeScreen.manFlow,largeScreen.womanFlow);if(largeScreen.wcStatisticsInfos!=null){myChartLineInit(largeScreen.wcStatisticsInfos)}if(largeScreen.setDataVos!=null){setDataUlInit(largeScreen.setDataVos)}}$(".loading").fadeOut()}}function fnDate(){var c=new Date();var d=c.getFullYear();var g=c.getMonth();var e=c.getDate();var a=c.getHours();var h=c.getMinutes();var b=c.getSeconds();var f=d+"-"+fnW((g+1))+"-"+fnW(e)+" "+fnW(a)+":"+fnW(h)+":"+fnW(b);$("#time").html(f)}function fnW(a){return a>=10?a:"0"+a}function myChartPieInit(a,c,b){var f=c;var e=b;var d=f+e;option1={series:[{type:"pie",radius:["70%","80%"],color:"#0088cc",label:{normal:{position:"center"}},data:[{value:a,name:"平均时长",label:{normal:{formatter:a+"",textStyle:{fontSize:20,color:"#fff"}}}}]}]};option2={series:[{type:"pie",radius:["70%","80%"],color:"#fccb00",label:{normal:{position:"center"}},data:[{value:f,name:"男厕流量",label:{normal:{formatter:f+"\n",textStyle:{fontSize:20,color:"#fff"}}}},{value:e,name:"男厕占比",label:{normal:{formatter:function(g){return"\n占比"+Math.round(f/d*100)+"%"},textStyle:{color:"#aaa",fontSize:12}}},itemStyle:{normal:{color:"rgba(255,255,255,.2)"},emphasis:{color:"#fff"}}}]}]};option3={series:[{type:"pie",radius:["70%","80%"],color:"#62b62f",label:{normal:{position:"center"}},data:[{value:e,name:"女厕流量",label:{normal:{formatter:e+"\n",textStyle:{fontSize:20,color:"#fff"}}}},{value:f,name:"女厕站比",label:{normal:{formatter:function(g){return"\n占比"+Math.round(e/d*100)+"%"},textStyle:{color:"#aaa",fontSize:12}}},itemStyle:{normal:{color:"rgba(255,255,255,.2)"},emphasis:{color:"#fff"}}}]}]};myChart1.setOption(option1);myChart2.setOption(option2);myChart3.setOption(option3)}function myChartLineInit(a){let xAxisData=new Array();let dataMaps=new Array();$.each(a,function(b,c){xAxisData[b]=c.date;dataMaps[b]=c.number});option4={title:{textStyle:{color:"rgb(85, 85, 85)",fontSize:18,fontStyle:"normal",fontWeight:"normal"}},grid:{left:"1%",right:"4%",bottom:"1%",containLabel:true},tooltip:{trigger:"axis"},legend:{selectedMode:false},xAxis:{type:"category",axisLabel:{textStyle:{color:"#fff"}},data:xAxisData},yAxis:{axisLabel:{textStyle:{color:"#fff"}},type:"value"},series:{type:"line",smooth:true,itemStyle:{normal:{color:"rgb("+Math.random()*255+", "+Math.random()*255+", "+Math.random()*255+")"}},data:dataMaps}};myChart4.setOption(option4)}function setDataUlInit(b){var a=$("#setDataUlId");a.find("li").remove();$.each(b,function(c,d){let setDataStr="<li><p>"+(c+1)+":"+d.wcTypeName+d.wcSetId+":开始于"+d.startTime+"起持续"+Math.round(d.time/1000)+"秒；</p></li>";a.append(setDataStr)})}function sensorDataUlInit(a){var b=$("#sensorDataUlId");b.find("li").remove();$.each(a,function(c,d){let text=d.value1Text==undefined?"":d.value1Text;let sensorDataStr="<li class='clearfix'><span class='pulll_left'>"+(c+1)+":"+d.sensorTypeName+"</span> <span class='pulll_right'> "+text+"</span></li>";b.append(sensorDataStr)})}function UsagePieInit(a,b){option6={series:[{type:"pie",radius:["70%","80%"],color:"#fccb00",label:{normal:{position:"center"}},data:[{value:b,name:"用电量",label:{normal:{formatter:b+"\n",textStyle:{fontSize:20,color:"#fff"}}}},{name:"用电量",label:{normal:{formatter:function(c){return"\n用电量"},textStyle:{color:"#aaa",fontSize:12}}}}]}]};option7={series:[{type:"pie",radius:["70%","80%"],color:"#0088cc",label:{normal:{position:"center"}},data:[{value:a,name:"用水量",label:{normal:{formatter:a+"\n",textStyle:{fontSize:20,color:"#fff"}}}},{name:"用水量",label:{normal:{formatter:function(c){return"\n用水量"},textStyle:{color:"#aaa",fontSize:12}}}}]}]};myChart6.setOption(option6);myChart7.setOption(option7)}$(window).resize(function(){myChart1.resize();myChart2.resize();myChart3.resize();myChart4.resize();myChart6.resize();myChart7.resize()});