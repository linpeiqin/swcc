var myChart;layui.config({base:ctx+"/common/echarts/"}).use(["layer","echarts"],function(){let layer=layui.layer;let echarts=layui.echarts;$.ajax({url:"/wc/wcInfo/wcInfoSelect",type:"get",dataType:"json",success:function(a){initPage(a,echarts)},error:function(a){layer.msg("请求失败")}})});function initPage(e,d){var f=new Array();var c=new Array();var b=0;var a=new Array();myChart=d.init(document.getElementById("chart"));$.each(e.data,function(h,g){$("#wcBrief").append('<li class="col-sm-12 col-md-6 col-xs-12"><a href="javascript:;" class="clearfix"><div class="icon-bg bg-org f-l"><span class="iconfont">&#xe606;</span></div><div class="right-text-con"><p><span class="color-org">'+g.info+'</span></p><p id="wc_total_'+g.wcId+'">总人次：0</p><p id="wc_left_'+g.wcId+'">剩余厕位：0</p></div></a></li>');$.ajax({url:"/wc/setData/getTotalUsage",type:"get",dataType:"json",data:{wcId:g.wcId,day:7},success:function(i){var j=new Array();$.each(i.data,function(k,l){f[b]=l.date;j[k]=l.number});a[b]=g.info;c[b]={name:g.info,type:"line",smooth:true,itemStyle:{normal:{areaStyle:{type:"default"},color:"rgb("+Math.random()*255+", "+Math.random()*255+", "+Math.random()*255+")"}},data:j};b=b+1;updateCharts(f,c,a)},error:function(i){layer.msg("请求失败")}})})}function updateCharts(b,a,c){myChart.setOption({title:{text:"近七天使用次数统计",textStyle:{color:"rgb(85, 85, 85)",fontSize:18,fontStyle:"normal",fontWeight:"normal"}},tooltip:{trigger:"axis"},legend:{data:c,selectedMode:false},toolbox:{show:true,feature:{dataView:{show:false,readOnly:true},magicType:{show:false,type:["line","bar","stack","tiled"]},restore:{show:true},saveAsImage:{show:true},mark:{show:false}}},calculable:false,xAxis:[{type:"category",boundaryGap:false,data:b}],yAxis:[{type:"value"}],grid:{x2:30,x:50},series:a})}window.onresize=function(){myChart.resize()};